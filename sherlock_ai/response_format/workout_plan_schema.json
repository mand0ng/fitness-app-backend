{
  "type": "json_schema",
  "name": "workout_plan_segment",
  "strict": true,
  "schema": {
    "type": "object",
    "properties": {
      "user_id": {
        "type": "string",
        "description": "user.id"
      },
      "start_date": {
        "type": "string",
        "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
        "description": "YYYY-MM-DD"
      },
      "total_days": {
        "type": "integer",
        "const": 30
      },
      "part_days": {
        "type": "string",
        "description": "e.g., '1-10', '11-20', '21-30'"
      },
      "notes_from_coach": {
        "type": "string",
        "description": "Coach notes incl. weight progression tips (empty for parts 2-3)"
      },
      "plan": {
        "type": "array",
        "minItems": 10,
        "maxItems": 10,
        "items": {
          "type": "object",
          "properties": {
            "day": {
              "type": "integer"
            },
            "date": {
              "type": "string",
              "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
            },
            "type": {
              "type": "string",
              "enum": ["workout", "rest"]
            },
            "workout": {
              "type": "object",
              "description": "Omit if type='rest'",
              "properties": {
                "warm_up": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "duration": {
                        "type": "string"
                      }
                    },
                    "required": ["name", "duration"],
                    "additionalProperties": false
                  }
                },
                "exercises": {
                  "type": "array",
                  "minItems": 4,
                  "maxItems": 6,
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "sets": {
                        "type": "integer"
                      },
                      "reps": {
                        "type": "string"
                      },
                      "rest": {
                        "type": "string"
                      },
                      "estimated_weight": {
                        "type": "string",
                        "description": "e.g., '20kg', '15-20kg DBs', 'bodyweight'. Progress +5-10% per phase"
                      },
                      "notes": {
                        "type": "string",
                        "description": "Optional tips"
                      }
                    },
                    "required": ["name", "sets", "reps", "rest", "estimated_weight"],
                    "additionalProperties": false
                  }
                },
                "cooldown": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": {
                        "type": "string"
                      },
                      "duration": {
                        "type": "string"
                      }
                    },
                    "required": ["name", "duration"],
                    "additionalProperties": false
                  }
                },
                "estimated_duration": {
                  "type": "string"
                },
                "focus": {
                  "type": "string"
                }
              },
              "required": ["warm_up", "exercises", "cooldown", "estimated_duration", "focus"],
              "additionalProperties": false
            }
          },
          "required": ["day", "date", "type"],
          "additionalProperties": false
        }
      }
    },
    "required": ["user_id", "start_date", "total_days", "part_days", "notes_from_coach", "plan"],
    "additionalProperties": false
  }
}